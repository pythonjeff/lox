<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOX FUND | Live Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header with LOX FUND branding -->
        <header class="header">
            <div class="logo-container">
                <span class="logo-lox">LOX</span>
                <span class="logo-fund">FUND</span>
                <div class="logo-underline"></div>
            </div>
            <div class="header-subtitle">Portfolio Dashboard</div>
            
            <!-- Regime Change Alert (hidden by default) -->
            <div class="regime-alert" id="regime-alert" style="display: none;">
                <span class="alert-icon">‚ö°</span>
                <span class="alert-text" id="alert-text">Regime shift detected</span>
                <button class="alert-dismiss" onclick="dismissAlert()">√ó</button>
            </div>
        </header>

        <!-- Summary Panel -->
        <section class="summary-panel">
            <div class="summary-item">
                <div class="summary-label">Liquidation NAV<span class="mark-tooltip" title="Longs at bid, shorts at ask">‚ìò</span></div>
                <div class="summary-value" id="nav-value">‚Äî</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Unrealized P&L<span class="mark-tooltip" title="Based on liquidation prices">‚ìò</span></div>
                <div class="summary-value" id="total-pnl">‚Äî</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Cash</div>
                <div class="summary-value" id="cash-available">‚Äî</div>
            </div>
        </section>
        
        <!-- Performance Comparison Card -->
        <section class="performance-card">
            <div class="performance-header">
                <h3>Performance Since Inception</h3>
                <span class="inception-date">Jan 9, 2026</span>
            </div>
            <div class="performance-metrics">
                <div class="perf-metric fund-return">
                    <div class="perf-label">LOX FUND</div>
                    <div class="perf-value" id="fund-return">‚Äî</div>
                </div>
                <div class="perf-vs">vs</div>
                <div class="perf-metric benchmark-metric">
                    <div class="perf-label">S&P 500</div>
                    <div class="perf-value" id="sp500-return">‚Äî</div>
                    <div class="perf-alpha" id="alpha-sp500">‚Äî</div>
                </div>
                <div class="perf-vs">vs</div>
                <div class="perf-metric benchmark-metric btc-metric">
                    <div class="perf-label">BTC/USD</div>
                    <div class="perf-value" id="btc-return">‚Äî</div>
                    <div class="perf-alpha" id="alpha-btc">‚Äî</div>
                </div>
            </div>
        </section>

        <!-- Palmer: Macro Intelligence -->
        <section class="palmer-section">
            <div class="palmer-header">
                <h2 class="palmer-name">PALMER</h2>
            </div>
            
            <!-- Traffic Light Indicators -->
            <div class="traffic-lights" id="traffic-lights">
                <div class="traffic-item" data-status="loading">
                    <span class="traffic-label">REGIME</span>
                    <span class="traffic-dot">‚óè</span>
                    <span class="traffic-value">‚Äî</span>
                </div>
                <div class="traffic-item" data-status="loading">
                    <span class="traffic-label">VOLATILITY</span>
                    <span class="traffic-dot">‚óè</span>
                    <span class="traffic-value">‚Äî</span>
                </div>
                <div class="traffic-item" data-status="loading">
                    <span class="traffic-label">CREDIT</span>
                    <span class="traffic-dot">‚óè</span>
                    <span class="traffic-value">‚Äî</span>
                </div>
                <div class="traffic-item" data-status="loading">
                    <span class="traffic-label">RATES</span>
                    <span class="traffic-dot">‚óè</span>
                    <span class="traffic-value">‚Äî</span>
                </div>
            </div>
            
            <!-- Palmer's Insight (prominent) -->
            <div class="palmer-insight" id="palmer-insight">
                <div class="insight-loading">Loading insight...</div>
            </div>
            
            <!-- LOX Expected Return Forecast -->
            <div class="forecast-card" id="forecast-card">
                <div class="forecast-header">
                    <span class="forecast-title">LOX 6-MONTH OUTLOOK</span>
                    <span class="forecast-regime" id="forecast-regime">‚Äî</span>
                </div>
                <div class="forecast-metrics">
                    <div class="forecast-metric">
                        <span class="forecast-label">EXPECTED RETURN</span>
                        <span class="forecast-value" id="forecast-expected">‚Äî</span>
                    </div>
                    <div class="forecast-metric">
                        <span class="forecast-label">TAIL RISK (5%)</span>
                        <span class="forecast-value forecast-risk" id="forecast-var95">‚Äî</span>
                    </div>
                    <div class="forecast-metric">
                        <span class="forecast-label">WIN PROBABILITY</span>
                        <span class="forecast-value" id="forecast-winrate">‚Äî</span>
                    </div>
                </div>
                <div class="forecast-footer">Based on current regime persisting</div>
            </div>
            
            <!-- Calendar & Headlines - Side by Side -->
            <div class="palmer-grid">
                <div class="palmer-grid-item">
                    <h4 class="grid-title">
                        <span class="grid-icon">üìÖ</span>
                        ECONOMIC CALENDAR
                        <span class="live-dot"></span>
                    </h4>
                    <div class="grid-content" id="palmer-events">
                        <div class="grid-loading">Loading...</div>
                    </div>
                    <a href="https://tradingeconomics.com/united-states/calendar" target="_blank" rel="noopener" class="grid-source">
                        View full calendar ‚Üí
                    </a>
                </div>
                <div class="palmer-grid-item">
                    <h4 class="grid-title">
                        <span class="grid-icon">üì∞</span>
                        PORTFOLIO NEWS
                    </h4>
                    <div class="grid-content" id="palmer-headlines">
                        <div class="grid-loading">Loading...</div>
                    </div>
                </div>
            </div>
            
        </section>

        <!-- Positions Table -->
        <section class="positions-section">
            <h2>Open Positions</h2>
            <div class="table-container">
                <table id="positions-table">
                    <thead>
                        <tr>
                            <th>Symbol</th>
                            <th>Quantity</th>
                            <th>Market Value</th>
                            <th>P&L</th>
                            <th>P&L %</th>
                        </tr>
                    </thead>
                    <tbody id="positions-body">
                        <tr>
                            <td colspan="5" class="loading">Loading positions...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Closed Trades (collapsible, least important) -->
        <details class="closed-trades-section">
            <summary class="closed-trades-toggle">
                <span class="toggle-title">Closed Trades</span>
                <span class="win-rate-badge" id="win-rate-badge">
                    <span class="win-rate-value" id="win-rate-value">‚Äî</span>
                </span>
                <span class="realized-pnl-badge" id="realized-pnl-badge">‚Äî</span>
            </summary>
            
            <!-- Summary Stats -->
            <div class="closed-stats" id="closed-stats">
                <div class="closed-stat">
                    <span class="stat-label">Wins</span>
                    <span class="stat-value wins" id="total-wins">‚Äî</span>
                </div>
                <div class="closed-stat">
                    <span class="stat-label">Losses</span>
                    <span class="stat-value losses" id="total-losses">‚Äî</span>
                </div>
            </div>
            
            <!-- Closed Trades Table -->
            <div class="table-container">
                <table id="closed-trades-table">
                    <thead>
                        <tr>
                            <th>Position</th>
                            <th>Cost</th>
                            <th>Proceeds</th>
                            <th>P&L</th>
                        </tr>
                    </thead>
                    <tbody id="closed-trades-body">
                        <tr>
                            <td colspan="4" class="loading">Loading closed trades...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </details>
        
        <!-- Footer -->
        <footer class="dashboard-footer">
            <div class="footer-content">
                <span class="footer-brand">LOX FUND</span>
                <span class="footer-divider">‚Ä¢</span>
                <span class="footer-updated" id="last-updated"></span>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
</body>
</html>
